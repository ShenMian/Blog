# 碰撞检测

## 阶段
- **Broad-Phase**: 快速排除不需要检测的情况, 减少下一步的计算量.
- **Narrow-Phase**: 对可能发生碰撞的物体进行碰撞检测和受力分析.

所有的 n 个物体都可能发送碰撞的情况下, 进行碰撞检测的时间复杂度为O(n^2). 这意味着碰撞检测的耗时将会随着物体数量的增多成指数倍增长, 成为性能瓶颈. 因此在进行碰撞检测之前要先对物体进行筛选, 尽可能的挑选出必须要进行碰撞检测的物体, 以减少不必要的计算.

## Broad-Phase
通过物体之间的相对位置和相对速度以及空间分区等可以将其进行快速分类, 部分物体之间不可能发生碰撞就没有必要再进一步进行碰撞检测和受力分析.
- 排序和扫描(Sort and Sweep)
- 空间分区(Spatial Subdivision)

## 碰撞体积(Bounding Volumes)
又称碰撞原型(collision primitive).  
参与碰撞检测的刚体可能具有复杂的外形, 将对性能造成严重的影响. 因此可以利用简化外形来提高碰撞检测的性能. 使用碰撞体积(包围盒)来替代实际的外形进行碰撞检测, 碰撞体积通常由几个简单的几何图形组成, 因此可以减少运算量并运用有针对性优化的算法. 常见的碰撞体积有:  
- **轴对齐包围盒(axis-aligned bounding boxes, AABB)**: 所有的边均平行于坐标系, 不需要考虑旋转角度等因素, 与其他 AABB 相交检测简单快速.
- **圆形(circle)**: 通常只适用于近似圆形的物体, 但针对这部分物体碰撞体积和实际外形可能十分接近, 与其他圆形包围盒相交检测简单快速.
- **球体(sphere)**: 最简单的三维体积, 也是最高效的三维碰撞体积.
- **胶囊体(capsule)**: 形似胶囊, 为线段扫掠球体(line swept sphere, LSS).
- **定向包围盒(oriented bounding box, OBB)**.
- **离散定向多胞形(discrete oriented polytope, DOP)**: k-DOP 是由 k 个平面构成的形状. AABB 与 OBB 都属于 6-POD.
- **多边形汤(polygon soup/poly soup)**: 支持完全任意/非凸的形状. 常用于复杂的静态表面建模, 如地形和建筑.
- **复合形状(compound shape)**: 由多个碰撞体积共同组成.

## 碰撞检测

### 常见碰撞体积相交判定
- AABB 与 AABB: 

### 分离轴定理(separating axis theorem)
大多数碰撞检测系统都会使用该定理. 此定理指出, 若能找到一个轴, 两个凸形状在该轴上的投影不重叠, 则两个形状不相交. 若这样的轴不存在, 则两个形状相交.  

## 参考
- https://developer.nvidia.com/gpugems/gpugems3/part-v-physics-simulation/chapter-32-broad-phase-collision-detection-cuda
