# 三维观察

## 流程

```
         模型变换           观察变换           投影变换           视口变换
模型坐标 --------> 世界坐标 --------> 观察坐标 --------> 投影坐标 --------> 屏幕坐标
局部空间           世界空间           观察空间           裁剪空间           屏幕空间
```

1. 模型变换

    将模型坐标系(modeling coordinate system)中的顶点坐标通过模型变换转移到世界坐标系中.

2. 观察变换

    计算世界坐标系到观察坐标系(viewing coordinate system, 也称视点坐标系)的变换. 以此计算模型顶点相对于观察坐标系的坐标.

3. 投影变换

    - 裁剪: 通过指定参数生成一个观察体(view volume), 仅保留观察体内的三维对象.
        - 截头锥体(frustum), 用于透视投影.
        - 正投影观察体(orthogonal-projection view volume), 用于正交投影(orthographic projection, 也称正投影(orthogonal projection)).
    - 投影: 将观察体内的三维对象投影到二维平面上. 该二维平面被称为观察平面或投影平面.

4. 视口变换

    将投影平面绘制到显示器上的指定区域.

## 投影

---

# 三维模型的表示

三维模型的网格由一组顶点(包括它们的索引, 坐标/颜色/法向量/纹理坐标等信息)和一组索引组成. 顶点组成网格的点, 而索引组成网格的线. 索引说明了哪些顶点之间应该连线.
这两部分数据从模型文件中读取出来, 并存放在顶点缓冲区(vertex buffer)和索引缓冲区(index buffer). 这两个缓冲区的数据将被提交给渲染器用于绘制图像.
顶点缓冲区的数据布局可以自定义, 所以在这之前还需要告知 GPU 如何解析顶点缓冲区中的数据. 用于描述数据布局的信息称为顶点属性, 能声明的顶点属性是有上限的, 一般由硬件决定. 这部分数据将在绘制时提交给着色器处理.

## OBJ 文件格式

了解 OBJ 文件格式有利于理解 3D 模型的表示方式.  
每行由关键字和数据组成.  
关键字:

- v: 顶点坐标, 数据为三个浮点数, 分别表示 x, y, z 坐标.
- f: 面, 数据为若干整数, 表示顶点的索引. 这些顶点构成一个面.

```obj
v 0.0  0.5  0.0 # 顶点 1, 坐标为 (0, 0.5, 0), 位于中上方
v -0.5 -0.5 0.0 # 顶点 2, 坐标为 (-0.5, 0.5, 0), 位于左下方
v 0.5  -0.5 0.0 # 顶点 3, 坐标为 (0.5, -0.5, 0), 位于右下方
f 1 2 3         # 顶点 1, 2, 3 连线, 构成一个三角形的面
```

点之间连成线, 线之间连成面, 面之间连成体.
