# 隐写

**英文**: Steganography.  

## 确定文件类型

对文件进行分析.  

```sh
file [file]
```

!!! info "CTF"
    若识别文件类型后使用相应软件无法打开可能是头部的 magic 数字缺失, 在文件头部添加对应的 magic 数字即可.  

## 文件分离

识别并分离又多个文件合成的单个文件.  

```sh
binwalk [file]    # 分析
binwalk -e [file] # 分离
```

binwalk 只是将附加的文件分离出来, 不包含第一个文件.  
若 binwalk 无法成功识别和分离, 可以使用 foremost:  

```sh
foremost [file] # 分离
cat output/audit.txt
```

foremost 并没有在标准输出中直接给出有价值的信息, 而是写入到了输出目录中的 `audit.txt` 文件里.  

当多个文件数据不是简单的依次追加在文件末尾时, 自动分离便会失效或输出无效内容. 这时需要进人工动分析并手动分离.  

```sh
dd if=[in_file] of=[out_file] bs=[block_size] count=[block_count] skip=[block_skip]
```

将 `in_file` 中从 `block_skip * block_size` 处开始大小为 `block_size * block_count` 的数据写入到 `out_file` 中.  
若数据不是一块一块的, 则可以将 `block_size` 设置为 1(默认单位为字节), 这样 `block_count` 就表示要导出的字节数, `block_skip` 表示要跳过的字节数.  
