# Compressed file

!!! info "CTF Pseudo-Encryption" The compressed file header and file header of versions earlier than RAR 5.0 have a bit used to indicate whether the file is encrypted, so pseudo-encryption can be achieved by modifying this bit. RAR 5.0 and later versions Use the encryption header, where Encryption flags are used to indicate whether there is a password check value.

[John the Ripper](https://github.com/openwall/john) can be used to extract the password hash of the archive.<br> There are many file formats that support hash value extraction, here are just a few:

```sh
zip2john [file] > hashes.txt
rar2john [file] > hashes.txt
```

!!! warning The extractor of some format files is written in script language, so it needs to use the corresponding interpreter to execute.

```sh
john hashes.txt        # 进行破解, 会包含破解结果和其他内容
john hashes.txt --show # 显示破解结果
```

[hashcat](https://github.com/hashcat/hashcat) can take full advantage of hardware performance to crack the hash value.

```sh
hashcat -m [hash_type_id] -a [attach_mode_id] [file|hash] [dict]
```

The `hash_type_id` and `attach_mode_id` can be viewed through `hashcat --help` .

!!! warning The result of using John the Ripper to extract the hash value does not only contain the hash value. If you want to pass it to hashcat, you need to remove the non-hash content first.

[Kraken](https://kraken.nswardh.com/) is a tool for cracking compressed files under Windows.

- Support zip, rar, 7z compressed files.
- By dictionary or rules (length range, prefix suffix, charset).
- Crack progress is automatically saved/recoverable.

## Expansion

- [RAR file format analysis](https://sp4n9x.github.io/2020/04/10/RAR%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%88%86%E6%9E%90/)
